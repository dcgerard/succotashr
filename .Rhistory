package?SQUAREM
?SQUAREM
squarem
devtools::load_all(".")
succotash()
succotash
library(cate)
library(help = "cate")
?fa.em
fa.em
qml_out
fa.em
?fa.em
devtools::use_package("cate", "Suggests")
devtools::load_all(".")
n <- 10
p <- 100
k <- 5
sig_alpha <- 1
sig_beta <- 1
sig_e <- 1
prop_null <- 0.8
itermax <- 500
sig_E_diag <- abs(rnorm(n = p,sd = sig_e))
null <- round(prop_null*p)
beta <- rbind(rnorm(p),c(rep(0,null),rnorm(p - null,sd = sig_beta)))
X <- cbind(rep(1,length = n),rnorm(n))
Z <- matrix(rnorm(n*k),nrow = n, ncol = k)
alpha <- matrix(rnorm(p*k,sd = sig_alpha),nrow = k,ncol = p)
E <- t(sig_E_diag * matrix(rnorm(n*p),ncol = n,nrow = p))
Y <- X %*% beta + Z %*% alpha + E
Y
succotash(Y,X,5,fa_method = "quasi_mle")
temp <- succotash(Y,X,5,fa_method = "quasi_mle")
temp
names(temp)
temp$sig_diag_scaled
devtools::load_all(".")
temp <- succotash(Y,X,5,fa_method = "quasi_mle")
temp
temp <- succotash(Y,X,5)
library(help = "cate")
devtools::load_all(".")
ls
ls()
library(devtools)
formatR::tidy_dir("R")
lintr::lint()
lintr::lint_package()
devtools::load_all(".")
devtools::document()
?succotash
?factor_mle
devtools::document()
devtools::document()
devtools::document()
?succotash_em
devtools::document()
?succotash_e
?succotash_em
devtools::document()
?succotash_given_alpha
devtools::document()
?succotash_given_alpha
library(sva)
library(help = "sva")
devtools::document()
devtools::document()
?succotash
devtools::document()
?succotash
devtools::document()
?succotash
devtools::document()
?succotash
devtools::document()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
?lintr::lint_package()
?lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
devtools::load_all(".")
devtools::document()
devtools::inst()
devtools::install()
?succotash
library(succotash)
library(succotashr)
?succotash
devtools::check()
devtools::check()
devtools::check()
devtools::check()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::check()
devtools::document()
devtools::install()
devtools::install()
ls
succotashr::succotash()
?succotas
?succotash
?succotash_em
library(help = "succotashr")
library(devtools)
devtools::load_all(".")
?factor_mle
devtools::build()
?succotash
?succotash_given_alpha
library(help = "succotashr")
?succotash_em
devtools::document()
?succotash
devtools::document()
devtools::load_all(".")
package?succotash()
package?succotashr
?succotashr
#'
devtools::document()
?succotashr
library(succotashr)
?succotashr
devtools::document()
library(succotashr)
?succotashr
devtools::document()
library(succotashr)
?succotashr
package?succotashr
library(succotashr)
devtools::install()
devtools::document()
devtools::document()
devtools::build()
library(succotashr)
?uniform_succ_given_alpha
devtools::document()
devtools::build()
?uniform_succ_given_alpha
devtools::build()
devtools::install()
devtools::use_package('ashr')
devtools::document()
devtools::build()
devtools::install()
devtools::document()
devtools::build()
devtools::install()
?succotash
?succotash
library(succotashr)
?succotash
devtools::build()
devtools::install()
devtools::document()
devtools::build()
devtools::install()
devtools::document()
devtools::build()
devtools::install()
devtools::document()
devtools::install()
devtools::check()
devtools::document()
devtools::check()
devtools::load_all(".")
devtools::document()
devtools::check()
devtools::document()
devtools::use_readme_rmd()
?cate::fa.pc
ESA
esaBcV::ESA
esaBcv::ESA
?fa.pc
pa.pc
cate::fa.pc
devtools::document()
devtools::load_all(".")
succotash
devtools::install()
?succotash_em
?succotashr::succotash_em
devtools::load_all(".")
devtools::document()
devtools::load_all(".")
devtools::document()
devtools::document()
devtools::install()
devtools::check()
devtools::document()
devtools::install()
devtools::check()
?devtools::use_package
devtools::use_package("ashr", type = "Suggests")
Y <- matrix(rnorn(100), nrow = 10)
Y <- matrix(rnorm(100), nrow = 10)
ashr::ash(Y, outputlevel = 4)
ashr::ash(Y, 1, outputlevel = 4)
ashr_out <- ashr::ash(Y, 1, outputlevel = 4)
names(ashr_out)
class(ashr_out$PosteriorMean)
length(ashr_out$PosteriorMean)
class(Y)
dim(ashr_out$PosteriorMean)
ashr_out$PosteriorMean
dim(Y)
?ash.workhorse
ashr_out$flash.data
str(ashr_out$flash.data)
ashr_out$flash.data$comp_postmean
class(ashr_out$flash.data$comp_postmean)
dim(ashr_out$flash.data$comp_postmean)
dim(ashr_out$flash.data$comp_postmean2)
dim(ashr_out$flash.data$comp_postmean)
ashr_out$flash.data$comp_postprob
ashr_out$flash.data$comp_postmean
ashr_out$flash.data$comp_postmean2
ashr_out$flash.data$comp_postmean
?comp_postmean
?comp_postmean2
devtools::install_github("NKweiwang/flash")
library(flash)
library(help = "flash")
?flash
flash_out <- flash(Y)
Y
flash::flash(Y = Y)
flash(Y)
flash
Y <- Y + rep(10, length = 10) %*% t(rep(1, length = 10))
Y
flash::flash(Y = Y)
flash::flash(Y = Y)
flash::flash(Y = Y)
flash::flash(Y = Y)
flash::flash(Y = Y)
flash::flash(Y = Y)
flash::flash(Y = Y)
Y_current <- Y
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
k <- 3
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
flash_out <- flash::flash(Y_current)
names(flash_out)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
for(conf_index in 1:k) {
flash_out <- flash::flash(Y_current)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
}
F_mat
L_mat
F_mat
flash_out <- flash::flash(Y_current)
flash_out
Y_current <- Y
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
for(conf_index in 1:k) {
flash_out <- flash::flash(Y_current)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
}
F_mat
Y_mat
L_mat
devtools::use_package("flash", type = "Suggests")
Y_current <- Y
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
var_vec <- rep(NA, length = k)
for(conf_index in 1:k) {
flash_out <- flash::flash(Y_current)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
var_vec[conf_idnex] <- flash_out$sigmae2
}
Y_current <- Y
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
var_vec <- rep(NA, length = k)
for(conf_index in 1:k) {
flash_out <- flash::flash(Y_current)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
var_vec[conf_index] <- flash_out$sigmae2
}
var_vec
mean(var_vec)
Y <- matrix(rnorm(200), nrow = 10)
Y_current <- Y
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
var_vec <- rep(NA, length = k)
for(conf_index in 1:k) {
flash_out <- flash::flash(Y_current)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
var_vec[conf_index] <- flash_out$sigmae2
}
alpha <- F_mat
mean(var_vec)
alpha
pca_out <- cate::fa.pc(Y = Y, r = k)
pca_out
dim(pca_out$Gamma)
dim(F_mat)
length(pca_out$Sigma)
alpha <- F_mat
alpha
devtools::install()
devtools::install()
devtools::document()
devtools::github_install("NKweiwang/flash")
devtools::install_github("NKweiwang/flash")
devtools::install_github("stephens999/ashr")
install.packages("Rcpp")
install.packages("Rcpp")
devtools::install_github("stephens999/ashr")
devtools::install_github("NKweiwang/flash")
devtools::document()
devtools::install()
?succotash
?succotashr
librarh(help = "flash")
library(help = "flash")
?flash_hd
?flash::flash_hd
?flash::flash_VEM
?flash:::flash_VEM
?greedy
?flash::greedy
flash::greedy
?flash::flash_hd
Y <- matrix(rnorm(200), nrow = 20)
flash::flash_hd(Y, partype = "anova")
f_out <- flash::flash_hd(Y, partype = "anova")
names(f_out)
class(f_out$sigmae2)
f_out <- flash::flash_hd(Y, partype = "loganova")
names(f_out)
f_out$sigmae2
svd(f_out$sigmae2)$d
flash::flash_hd
flash:::sigmaest()
flash:::sigmaest
flash
flash::flash_hd
flash::flash_hd
Y_current <- matrix(nrorm(200), ncol = 10)
Y_current <- matrix(rnorm(200), ncol = 20)
flash_out <- flash::flash_hd(Y_current, partype = "hetero_col")
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
flash_out$l
flash_out$f
flash_out$sigmae2
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
k <- 3
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
sig_diag <- rep(0, length = ncol(Y_current))
for(conf_index in 1:k) {
flash_out <- flash::flash_hd(Y_current, partype = "hetero_col")
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
sig_diag <- sig_diag + flash_out$sigmae2[1,]
}
sig_diag <- sig_diag / k
sig_diag
alpha <- F_mat
alpha
L_mat
devtools::document()
devtools::install()
cate::fa.pc
Y_current <- matrix(rnorm(200), ncol = 10)
Y_current <- matrix(rnorm(200), ncol = 20)
svdY <- svd(Y_current)
alpha <- svdY$v[, 1:k] %*% diag(svdY$d[1:k], k, k) / sqrt(nrow(Y_current))
k <- 2
alpha <- svdY$v[, 1:k] %*% diag(svdY$d[1:k], k, k) / sqrt(nrow(Y_current))
Ztemp <- sqrt(nrow(Y_current)) * svdY$u[, 1:k]
sig_diag <- rep((Y - Ztemp %*% t(alpha)) ^ 2 / (max(dim(Y_current)) * (min(dim(Y_current)) - k)), ncol(Y_current))
sig_diag <- rep((Y_current - Ztemp %*% t(alpha)) ^ 2 / (max(dim(Y_current)) * (min(dim(Y_current)) - k)), ncol(Y_current))
sig_diag
sig_diag <- rep(sum((Y_current - Ztemp %*% t(alpha)) ^ 2) / (max(dim(Y_current)) * (min(dim(Y_current)) - k)), ncol(Y_current))
sig_diag
devtools::document()
devtools::install()
devtools::document()
devtools::use_package("limma", type = "Suggests")
devtools::document()
devtools::document()
devtools::install()
devtools::check()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::document()
devtools::install()
devtools::document()
devtools::install()
devtools::inst()
devtools::install()
?devtools::install
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::use_package("flashr", type = "Suggests")
devtools::document()
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::inst()
devtools::install()
devtools::document()
devtools::install()
devtools::install()
devtools::install()
devtools::document()
devtools::install()
devtools::install()
devtools::install()
devtools::install()
devtools::document()
devtools::install()
succotashr::pca_shrinkvar()
succotashr:::pca_shrinkvar()
succotashr:::pca_shrinkvar
devtools::document()
devtools::inst()
devtools::install()
devtools::inst()
devtools::document()
devtools::install()
devtools::install()
devtools::document()
devtools::install()
n <- 10
p <- 1000
k <- 2
I <- n
K <- p
S <- k
S
K
I
I * K - K - I * S - K * S + S^2 + S
devtools::document()
devtools::install()
devtools::document()
devtools::document()
devtools::install()

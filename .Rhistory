devtools::check()
devtools::document()
devtools::check()
devtools::load_all(".")
devtools::document()
devtools::check()
devtools::document()
devtools::use_readme_rmd()
?cate::fa.pc
ESA
esaBcV::ESA
esaBcv::ESA
?fa.pc
pa.pc
cate::fa.pc
devtools::document()
devtools::load_all(".")
succotash
devtools::install()
?succotash_em
?succotashr::succotash_em
devtools::load_all(".")
devtools::document()
devtools::load_all(".")
devtools::document()
devtools::document()
devtools::install()
devtools::check()
devtools::document()
devtools::install()
devtools::check()
?devtools::use_package
devtools::use_package("ashr", type = "Suggests")
Y <- matrix(rnorn(100), nrow = 10)
Y <- matrix(rnorm(100), nrow = 10)
ashr::ash(Y, outputlevel = 4)
ashr::ash(Y, 1, outputlevel = 4)
ashr_out <- ashr::ash(Y, 1, outputlevel = 4)
names(ashr_out)
class(ashr_out$PosteriorMean)
length(ashr_out$PosteriorMean)
class(Y)
dim(ashr_out$PosteriorMean)
ashr_out$PosteriorMean
dim(Y)
?ash.workhorse
ashr_out$flash.data
str(ashr_out$flash.data)
ashr_out$flash.data$comp_postmean
class(ashr_out$flash.data$comp_postmean)
dim(ashr_out$flash.data$comp_postmean)
dim(ashr_out$flash.data$comp_postmean2)
dim(ashr_out$flash.data$comp_postmean)
ashr_out$flash.data$comp_postprob
ashr_out$flash.data$comp_postmean
ashr_out$flash.data$comp_postmean2
ashr_out$flash.data$comp_postmean
?comp_postmean
?comp_postmean2
devtools::install_github("NKweiwang/flash")
library(flash)
library(help = "flash")
?flash
flash_out <- flash(Y)
Y
flash::flash(Y = Y)
flash(Y)
flash
Y <- Y + rep(10, length = 10) %*% t(rep(1, length = 10))
Y
flash::flash(Y = Y)
flash::flash(Y = Y)
flash::flash(Y = Y)
flash::flash(Y = Y)
flash::flash(Y = Y)
flash::flash(Y = Y)
flash::flash(Y = Y)
Y_current <- Y
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
k <- 3
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
flash_out <- flash::flash(Y_current)
names(flash_out)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
for(conf_index in 1:k) {
flash_out <- flash::flash(Y_current)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
}
F_mat
L_mat
F_mat
flash_out <- flash::flash(Y_current)
flash_out
Y_current <- Y
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
for(conf_index in 1:k) {
flash_out <- flash::flash(Y_current)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
}
F_mat
Y_mat
L_mat
devtools::use_package("flash", type = "Suggests")
Y_current <- Y
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
var_vec <- rep(NA, length = k)
for(conf_index in 1:k) {
flash_out <- flash::flash(Y_current)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
var_vec[conf_idnex] <- flash_out$sigmae2
}
Y_current <- Y
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
var_vec <- rep(NA, length = k)
for(conf_index in 1:k) {
flash_out <- flash::flash(Y_current)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
var_vec[conf_index] <- flash_out$sigmae2
}
var_vec
mean(var_vec)
Y <- matrix(rnorm(200), nrow = 10)
Y_current <- Y
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
var_vec <- rep(NA, length = k)
for(conf_index in 1:k) {
flash_out <- flash::flash(Y_current)
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
var_vec[conf_index] <- flash_out$sigmae2
}
alpha <- F_mat
mean(var_vec)
alpha
pca_out <- cate::fa.pc(Y = Y, r = k)
pca_out
dim(pca_out$Gamma)
dim(F_mat)
length(pca_out$Sigma)
alpha <- F_mat
alpha
devtools::install()
devtools::install()
devtools::document()
devtools::github_install("NKweiwang/flash")
devtools::install_github("NKweiwang/flash")
devtools::install_github("stephens999/ashr")
install.packages("Rcpp")
install.packages("Rcpp")
devtools::install_github("stephens999/ashr")
devtools::install_github("NKweiwang/flash")
devtools::document()
devtools::install()
?succotash
?succotashr
librarh(help = "flash")
library(help = "flash")
?flash_hd
?flash::flash_hd
?flash::flash_VEM
?flash:::flash_VEM
?greedy
?flash::greedy
flash::greedy
?flash::flash_hd
Y <- matrix(rnorm(200), nrow = 20)
flash::flash_hd(Y, partype = "anova")
f_out <- flash::flash_hd(Y, partype = "anova")
names(f_out)
class(f_out$sigmae2)
f_out <- flash::flash_hd(Y, partype = "loganova")
names(f_out)
f_out$sigmae2
svd(f_out$sigmae2)$d
flash::flash_hd
flash:::sigmaest()
flash:::sigmaest
flash
flash::flash_hd
flash::flash_hd
Y_current <- matrix(nrorm(200), ncol = 10)
Y_current <- matrix(rnorm(200), ncol = 20)
flash_out <- flash::flash_hd(Y_current, partype = "hetero_col")
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
flash_out$l
flash_out$f
flash_out$sigmae2
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
k <- 3
L_mat <- matrix(NA, nrow = nrow(Y_current), ncol = k)
F_mat <- matrix(NA, nrow = ncol(Y_current), ncol = k)
sig_diag <- rep(0, length = ncol(Y_current))
for(conf_index in 1:k) {
flash_out <- flash::flash_hd(Y_current, partype = "hetero_col")
Y_current <- Y_current - flash_out$l %*% t(flash_out$f)
L_mat[, conf_index] <- flash_out$l
F_mat[, conf_index] <- flash_out$f
sig_diag <- sig_diag + flash_out$sigmae2[1,]
}
sig_diag <- sig_diag / k
sig_diag
alpha <- F_mat
alpha
L_mat
devtools::document()
devtools::install()
cate::fa.pc
Y_current <- matrix(rnorm(200), ncol = 10)
Y_current <- matrix(rnorm(200), ncol = 20)
svdY <- svd(Y_current)
alpha <- svdY$v[, 1:k] %*% diag(svdY$d[1:k], k, k) / sqrt(nrow(Y_current))
k <- 2
alpha <- svdY$v[, 1:k] %*% diag(svdY$d[1:k], k, k) / sqrt(nrow(Y_current))
Ztemp <- sqrt(nrow(Y_current)) * svdY$u[, 1:k]
sig_diag <- rep((Y - Ztemp %*% t(alpha)) ^ 2 / (max(dim(Y_current)) * (min(dim(Y_current)) - k)), ncol(Y_current))
sig_diag <- rep((Y_current - Ztemp %*% t(alpha)) ^ 2 / (max(dim(Y_current)) * (min(dim(Y_current)) - k)), ncol(Y_current))
sig_diag
sig_diag <- rep(sum((Y_current - Ztemp %*% t(alpha)) ^ 2) / (max(dim(Y_current)) * (min(dim(Y_current)) - k)), ncol(Y_current))
sig_diag
devtools::document()
devtools::install()
devtools::document()
devtools::use_package("limma", type = "Suggests")
devtools::document()
devtools::document()
devtools::install()
devtools::check()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::document()
devtools::install()
devtools::document()
devtools::install()
devtools::inst()
devtools::install()
?devtools::install
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::check()
devtools::install()
devtools::document()
devtools::install()
devtools::use_package("flashr", type = "Suggests")
devtools::document()
devtools::install()
devtools::document()
devtools::install()
devtools::document()
devtools::inst()
devtools::install()
devtools::document()
devtools::install()
devtools::install()
devtools::install()
devtools::document()
devtools::install()
devtools::install()
devtools::install()
devtools::install()
devtools::document()
devtools::install()
succotashr::pca_shrinkvar()
succotashr:::pca_shrinkvar()
succotashr:::pca_shrinkvar
devtools::document()
devtools::inst()
devtools::install()
devtools::inst()
devtools::document()
devtools::install()
devtools::install()
devtools::document()
devtools::install()
n <- 10
p <- 1000
k <- 2
I <- n
K <- p
S <- k
S
K
I
I * K - K - I * S - K * S + S^2 + S
devtools::document()
devtools::install()
devtools::document()
devtools::document()
devtools::install()
devtools::document()
devtools::install()
devtools::install()
devtools::load_all()
library(succotashr)
Y <- matrix(rnorm(n * p), nrow = n, ncol = p)
n <- 10
p <- 100
Y <- matrix(rnorm(n * p), nrow = n, ncol = p)
X <- matrix(rnorm(n), nrow = n)
?succotash
succotash(Y, X, 2, mixtype = "uniform")
succotash(Y, X, 2, mix_type = "uniform")
probs
names(probs)
class(probs)
mix_fit
ashr:::comp_sd()
ashr:::comp_sd
?ashr:::comp_sd
?ashr::comp_sd
probs
class(probs)
?cdf_post
?comppostProb
?comppostprob
lfdr
?comppoostprob
?comppostprob
?cdf_post
NegativeProb = rep(0, length = n)
NegativeProb[completeobs] <-
cdf_post(mix_fit, 0,
betahat = c(Y - az),
sebetahat = sqrt(sig_diag), df = rep(1000, p)) -
lfdr
NegativeProb = rep(0, length = n)
NegativeProb[completeobs] <-
ashr::cdf_post(mix_fit, 0,
betahat = c(Y - az),
sebetahat = sqrt(sig_diag), df = rep(1000, p)) -
lfdr
NegativeProb = rep(0, length = n)
NegativeProb[completeobs] <-
ashr::cdf_post(mix_fit, 0,
betahat = c(Y - az),
sebetahat = sqrt(sig_diag), v = rep(1000, p)) -
lfdr
NegativeProb = rep(0, length = n)
NegativeProb <-
ashr::cdf_post(mix_fit, 0,
betahat = c(Y - az),
sebetahat = sqrt(sig_diag), v = rep(1000, p)) -
lfdr
NegativeProb
lfdr
NegativeProb
lfsr = ashr::compute_lfsr(NegativeProb, lfdr)
lfsr = ashr:::compute_lfsr(NegativeProb, lfdr)
ashr:::compute_lfsr
lfsr = ifelse(NegativeProb > 0.5 * (1 - lfdr), 1 - NegativeProb,
NegativeProb + lfdr)
NegativeProb = rep(0, length = n)
NegativeProb <-
ashr::cdf_post(mix_fit, 0,
betahat = c(Y - az),
sebetahat = sqrt(sig_diag), v = rep(1000, p)) -
lfdr
lfsr = ifelse(NegativeProb > 0.5 * (1 - lfdr), 1 - NegativeProb,
NegativeProb + lfdr)
#        sq_out <-
lfsr
lfdr
hist(lfdr)
hist(lfsr)
devtools::load_all()
devtools::install()
devtools::install()
devtools::install()
devtools::load_all()
Y <- readRDS("y_temp.rds")
X <- readRDS("x_temp.rds")
k <- sva::num.sv(dat = t(Y), mod = model.matrix(~X))
succotash(Y = Y, X = X, k = k, likelihood = "t")
Y <- readRDS("../check_succ/y_temp.rds")
X <- readRDS("../check_succ/x_temp.rds")
devtools::load_all()
Y <- readRDS("../check_succ/y_temp.rds")
X <- readRDS("../check_succ/x_temp.rds")
k <- sva::num.sv(dat = t(Y), mod = model.matrix(~X))
succotash(Y = Y, X = X, k = k, likelihood = "t")
succotash(Y = Y, X = X, k = k, likelihood = "t")
recover()
recover()
recover()
k
devtools::load_all()
Y <- readRDS("../check_succ/y_temp.rds")
X <- readRDS("../check_succ/x_temp.rds")
k <- sva::num.sv(dat = t(Y), mod = model.matrix(~X))
k
k <- 1
succotash(Y = Y, X = X, k = k, likelihood = "t")
Z_old
par
fn
recover()
pi_new
Z_old
devtools::load_all()
Y <- readRDS("../check_succ/y_temp.rds")
X <- readRDS("../check_succ/x_temp.rds")
k <- sva::num.sv(dat = t(Y), mod = model.matrix(~X))
k <- 2
succotash(Y = Y, X = X, k = k, likelihood = "t")
succotash(Y = Y, X = X, k = k, likelihood = "normal", mixcompdist = "uniform")
devtools::load_all()
Y <- readRDS("../check_succ/y_temp.rds")
X <- readRDS("../check_succ/x_temp.rds")
k <- sva::num.sv(dat = t(Y), mod = model.matrix(~X))
k <- 2
succotash(Y = Y, X = X, k = k, likelihood = "normal", mixcompdist = "uniform")
succotash(Y = Y, X = X, k = k, likelihood = "normal", mix_type = "uniform")
left_ispos
left_means
sig_diag
Y
az
Z_current
pi_Z
recover()
Z_old
Z_new
gradient_val
hessian_val
mult_val
top_left
top_right
dpratios_left
dpratios_right
sug_diag
sig_diag
any(is.na(top_left))
any(is.na(top_right))
any(is.na(pnorm_diff_left))
any(is.na(pnorm_diff_right))
any(is.na(sig_diag))
any(is.na(diag_weights))
any(is.na(alpha))
any(is.na(dpratios_left))
any(is.na(dpratios_right))
any(is.na(Tkj))
any(is.na(top_left))
any(is.na(top_right))
any(is.na(dnorm_diff_left))
any(is.na(dnorm_diff_right))
any(is.na(pnorm_diff_left))
any(is.na(pnorm_diff_right))
any(is.na(dpratios_left))
min(pnorm_diff_left)
min(pnorm_diff_right)
min(dnorm_diff_right)
min(dnorm_diff_left)
devtools::install()
devtools::test()
devtools::install()
devtools::test()
devtools::chec()
devtools::check()
pca_naive()
pca_naive
succotash
